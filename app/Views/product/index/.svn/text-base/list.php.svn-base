<?= View::get('layout.header') ?>

<?= View::get("qihoo.menu.pageheader") ?>

<div class="row">
  <div class="col-md-12">
    <form class="form-horizontal" id="queryform" action="<?= URL::route('Qihoo\MenuController@postQueryAction') ?>" method="post">
        <div class="form-group">
            <label class="col-md-1 control-label">菜单级别</label>
            <select class="col-md-2 form-control input-small" name="level" id="level">
              <option value="0">全部</option>
              <option value="1">一级菜单</option>
              <option value="2">二级菜单</option>
              <option value="3">三级菜单</option>
            </select>
        </div>
        <div class="form-group">
            <label class="col-md-1 control-label"></label>
            <button type="submit" class="btn btn-primary" id="queryform_sub">查询</button>
        </div>
    </form>

    <div class="portlet" id="query_result">
    <?php include View::path("qihoo.menu.query") ?>
    </div>

  </div><!--col-md-12-->
</div><!--row-->

<script type="text/javascript">
$(function () {
    //获取查询参数，使用queryform时必须先预定义此函数
    var getParams = function() {
        var params = {
            "level" : $.trim($('#level').val())
        };
        return params;
    }

    <?= View::get("layout.query.queryform", array("requestUrl" => URL::route("Qihoo\MenuController@postQueryAction"))) ?>

    <?= View::get("layout.query.querypage", array("requestUrl" => URL::route("Qihoo\MenuController@postQueryAction")))
 ?>

    <?= View::get("layout.query.bindevent") ?>

    bindEvt();

    $(document).delegate("#delete_record", 'click', function(){
        result = confirm("删除菜单会同时删除菜单下的所有路由，你确定要删除吗？");
        if (result) {
            return true;
        } else {
            return false;
        }
    });
});
</script>

<?= View::get('layout.footer') ?>
